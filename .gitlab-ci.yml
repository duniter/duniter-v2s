stages:
  - gx_build
  - gx_package
  - gx_release

build_gdev_runtime:
  stage: gx_build
  rules:
    - when: manual
  image: python:3.9.18
  script:
    - echo "Build gdev runtime using srtool"
  tags:
    - kepler

build_gtest_runtime:
  stage: gx_build
  rules:
    - when: manual
      allow_failure: true
  image: python:3.9.18
  script:
    - echo "Build gtest runtime using srtool"
    - echo "Sleep..."
    - sleep 60
    - echo "Fin"
  tags:
    - kepler

create_release:
  stage: gx_package
  rules:
    - when: always
  image: python:3.9.18
  script:
    - echo "Create release page"
  tags:
    - kepler

release_gdev_runtime:
  stage: gx_release
  needs:
    - build_gdev_runtime
    - create_release
  rules:
    - when: manual
  image: python:3.9.18
  script:
    - echo "Push runtime to release page"
  tags:
    - kepler

release_gtest_runtime:
  stage: gx_release
  needs:
    - build_gtest_runtime
    - create_release
  rules:
    - when: manual
  image: python:3.9.18
  script:
    - echo "Push runtime to release page"
  tags:
    - kepler
